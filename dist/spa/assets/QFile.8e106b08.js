import{c as K,aA as X,az as Y,a as o,C as G,h as m,V as R,aC as H,aw as J,s as w,g as E,r as T,av as Z,n as ee,aa as te,a8 as le}from"./index.a8db99c8.js";import{u as ie,a as ne}from"./use-dark.93d8ea25.js";import{u as ae,a as ue,b as re,c as oe,d as ce,f as Q}from"./QInput.66be7811.js";import{u as se,a as de}from"./use-form.7422adbb.js";import{h as fe}from"./format.2a3572e1.js";const me={xs:8,sm:10,md:14,lg:20,xl:24};var ve=K({name:"QChip",props:{...ie,...X,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:d,emit:b}){const{proxy:{$q:g}}=E(),r=ne(e,g),c=Y(e,me),y=o(()=>e.selected===!0||e.icon!==void 0),x=o(()=>e.selected===!0?e.iconSelected||g.iconSet.chip.selected:e.icon),k=o(()=>e.iconRemove||g.iconSet.chip.remove),F=o(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),_=o(()=>{const i=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(i?` text-${i} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(F.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(r.value===!0?" q-chip--dark q-dark":"")}),p=o(()=>{const i=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},q={...i,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||g.lang.label.remove};return{chip:i,remove:q}});function z(i){i.keyCode===13&&V(i)}function V(i){e.disable||(b("update:selected",!e.selected),b("click",i))}function D(i){(i.keyCode===void 0||i.keyCode===13)&&(w(i),e.disable===!1&&(b("update:modelValue",!1),b("remove")))}function u(){const i=[];F.value===!0&&i.push(m("div",{class:"q-focus-helper"})),y.value===!0&&i.push(m(R,{class:"q-chip__icon q-chip__icon--left",name:x.value}));const q=e.label!==void 0?[m("div",{class:"ellipsis"},[e.label])]:void 0;return i.push(m("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},H(d.default,q))),e.iconRight&&i.push(m(R,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&i.push(m(R,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:k.value,...p.value.remove,onClick:D,onKeyup:D})),i}return()=>{if(e.modelValue===!1)return;const i={class:_.value,style:c.value};return F.value===!0&&Object.assign(i,p.value.chip,{onClick:V,onKeyup:z}),G("div",i,u(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[J,e.ripple]])}}});function j(e,d,b,g){const r=[];return e.forEach(c=>{g(c)===!0?r.push(c):d.push({failedPropValidation:b,file:c})}),r}function P(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),w(e)}const ge={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},he=["rejected"];function be({editable:e,dnd:d,getFileInput:b,addFilesToQueue:g}){const{props:r,emit:c,proxy:y}=E(),x=T(null),k=o(()=>r.accept!==void 0?r.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),F=o(()=>parseInt(r.maxFiles,10)),_=o(()=>parseInt(r.maxTotalSize,10));function p(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&Z(t);else{const h=b();h&&h!==t.target&&h.click(t)}}function z(t){e.value&&t&&g(null,t)}function V(t,h,A,N){let n=Array.from(h||t.target.files);const v=[],C=()=>{v.length!==0&&c("rejected",v)};if(r.accept!==void 0&&k.value.indexOf("*/")===-1&&(n=j(n,v,"accept",a=>k.value.some(s=>a.type.toUpperCase().startsWith(s)||a.name.toUpperCase().endsWith(s))),n.length===0))return C();if(r.maxFileSize!==void 0){const a=parseInt(r.maxFileSize,10);if(n=j(n,v,"max-file-size",s=>s.size<=a),n.length===0)return C()}if(r.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(a=>{a.__key=a.webkitRelativePath+a.lastModified+a.name+a.size}),N===!0){const a=A.map(s=>s.__key);n=j(n,v,"duplicate",s=>a.includes(s.__key)===!1)}if(n.length===0)return C();if(r.maxTotalSize!==void 0){let a=N===!0?A.reduce((s,B)=>s+B.size,0):0;if(n=j(n,v,"max-total-size",s=>(a+=s.size,a<=_.value)),n.length===0)return C()}if(typeof r.filter=="function"){const a=r.filter(n);n=j(n,v,"filter",s=>a.includes(s))}if(r.maxFiles!==void 0){let a=N===!0?A.length:0;if(n=j(n,v,"max-files",()=>(a++,a<=F.value)),n.length===0)return C()}if(C(),n.length!==0)return n}function D(t){P(t),d.value!==!0&&(d.value=!0)}function u(t){w(t),(t.relatedTarget!==null||ee.is.safari!==!0?t.relatedTarget!==x.value:document.elementsFromPoint(t.clientX,t.clientY).includes(x.value)===!1)===!0&&(d.value=!1)}function i(t){P(t);const h=t.dataTransfer.files;h.length!==0&&g(null,h),d.value=!1}function q(t){if(d.value===!0)return m("div",{ref:x,class:`q-${t}__dnd absolute-full`,onDragenter:P,onDragover:P,onDragleave:u,onDrop:i})}return Object.assign(y,{pickFiles:p,addFiles:z}),{pickFiles:p,addFiles:z,onDragover:D,onDragleave:u,processFiles:V,getDndNode:q,maxFilesNumber:F,maxTotalSizeNumber:_}}var pe=K({name:"QFile",inheritAttrs:!1,props:{...ae,...se,...ge,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ue,...he],setup(e,{slots:d,emit:b,attrs:g}){const{proxy:r}=E(),c=re(),y=T(null),x=T(!1),k=de(e),{pickFiles:F,onDragover:_,onDragleave:p,processFiles:z,getDndNode:V}=be({editable:c.editable,dnd:x,getFileInput:$,addFilesToQueue:L}),D=oe(e),u=o(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),i=o(()=>Q(u.value)),q=o(()=>u.value.map(l=>l.name).join(", ")),t=o(()=>fe(u.value.reduce((l,f)=>l+f.size,0))),h=o(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),A=o(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:k.value,...g,id:c.targetUid.value,disabled:c.editable.value!==!0})),N=o(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),n=o(()=>e.multiple===!0&&e.append===!0);function v(l){const f=u.value.slice();f.splice(l,1),a(f)}function C(l){const f=u.value.indexOf(l);f>-1&&v(f)}function a(l){b("update:modelValue",e.multiple===!0?l:l[0])}function s(l){l.keyCode===13&&le(l)}function B(l){(l.keyCode===13||l.keyCode===32)&&F(l)}function $(){return y.value}function L(l,f){const S=z(l,f,u.value,n.value),O=$();O!=null&&(O.value=""),S!==void 0&&((e.multiple===!0?e.modelValue&&S.every(W=>u.value.includes(W)):e.modelValue===S[0])||a(n.value===!0?u.value.concat(S):S))}function I(){return[m("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function U(){if(d.file!==void 0)return u.value.length===0?I():u.value.map((f,S)=>d.file({index:S,file:f,ref:this}));if(d.selected!==void 0)return u.value.length===0?I():d.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?I():u.value.map((f,S)=>m(ve,{key:"file-"+S,removable:c.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{v(S)}},()=>m("span",{class:"ellipsis",textContent:f.name})));const l=e.displayValue!==void 0?e.displayValue:q.value;return l.length!==0?[m("div",{class:e.inputClass,style:e.inputStyle,textContent:l})]:I()}function M(){const l={ref:y,...A.value,...D.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:L};return e.multiple===!0&&(l.multiple=!0),m("input",l)}return Object.assign(c,{fieldClass:N,emitValue:a,hasValue:i,inputRef:y,innerValue:u,floatingLabel:o(()=>i.value===!0||Q(e.displayValue)),computedCounter:o(()=>{if(e.counterLabel!==void 0)return e.counterLabel(h.value);const l=e.maxFiles;return`${u.value.length}${l!==void 0?" / "+l:""} (${t.value})`}),getControlChild:()=>V("file"),getControl:()=>{const l={ref:c.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return c.editable.value===!0&&Object.assign(l,{onDragover:_,onDragleave:p,onKeydown:s,onKeyup:B}),m("div",l,[M()].concat(U()))}}),Object.assign(r,{removeAtIndex:v,removeFile:C,getNativeElement:()=>y.value}),te(r,"nativeEl",()=>y.value),ce(c)}});export{pe as Q,ve as a};
